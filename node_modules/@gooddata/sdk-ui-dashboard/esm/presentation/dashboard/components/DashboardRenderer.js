import { __assign } from "tslib";
// (C) 2022 GoodData Corporation
import { BackendProvider, WorkspaceProvider, ErrorComponent as DefaultError, LoadingComponent as DefaultLoading, } from "@gooddata/sdk-ui";
import { OverlayController, ToastMessageContextProvider, OverlayControllerProvider, } from "@gooddata/sdk-ui-kit";
import { ThemeProvider } from "@gooddata/sdk-ui-theme-provider";
import React from "react";
import { DashboardStoreProvider } from "../../../model";
import { ExportDialogContextProvider, DashboardCustomizationsProvider, DashboardComponentsProvider, DashboardConfigProvider, } from "../../dashboardContexts";
import { DefaultFilterBar } from "../../filterBar";
import { DefaultDashboardLayout } from "../../layout";
import { DefaultSaveAsDialog } from "../../saveAs";
import { DefaultScheduledEmailDialog, DefaultScheduledEmailManagementDialog } from "../../scheduledEmail";
import { DefaultShareDialog } from "../../shareDialog";
import { DefaultButtonBar, DefaultMenuButton, DefaultSaveButton, DefaultTopBar, RenderModeAwareTitle, } from "../../topBar";
import { defaultDashboardThemeModifier } from "../defaultDashboardThemeModifier";
import { useDashboard } from "../hooks/useDashboard";
import { DashboardLoading } from "./DashboardLoading";
import { DndProvider } from "react-dnd";
import { HTML5Backend } from "react-dnd-html5-backend";
import { DefaultEmptyLayoutDropZoneBody, DragLayerComponent, LayoutResizeStateProvider, } from "../../dragAndDrop";
import { RenderModeAwareDashboardSidebar } from "../DashboardSidebar/RenderModeAwareDashboardSidebar";
/**
 * @internal
 */
export var DashboardRenderer = function (props) {
    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r;
    var _s = useDashboard(props), backend = _s.backend, workspace = _s.workspace, hasThemeProvider = _s.hasThemeProvider, dashboardOrRef = _s.dashboardOrRef, attributeFilterProvider = _s.attributeFilterProvider, dateFilterProvider = _s.dateFilterProvider, widgetProvider = _s.widgetProvider, insightProvider = _s.insightProvider, insightBodyProvider = _s.insightBodyProvider, insightMenuButtonProvider = _s.insightMenuButtonProvider, insightMenuProvider = _s.insightMenuProvider, kpiProvider = _s.kpiProvider, insightWidgetComponentSet = _s.insightWidgetComponentSet, kpiWidgetComponentSet = _s.kpiWidgetComponentSet, attributeFilterComponentSet = _s.attributeFilterComponentSet;
    var dashboardRender = (React.createElement(BackendProvider, { backend: backend },
        React.createElement(WorkspaceProvider, { workspace: workspace },
            React.createElement(OverlayControllerProvider, { overlayController: OverlayController.getInstance() },
                React.createElement(DashboardStoreProvider, { backend: props.backend, workspace: props.workspace, dashboard: dashboardOrRef, filterContextRef: props.filterContextRef, eventHandlers: props.eventHandlers, config: props.config, permissions: props.permissions, onStateChange: props.onStateChange, onEventingInitialized: props.onEventingInitialized, additionalReduxContext: props.additionalReduxContext, customizationFns: props.customizationFns },
                    React.createElement(ToastMessageContextProvider, null,
                        React.createElement(ExportDialogContextProvider, null,
                            React.createElement(DashboardCustomizationsProvider, { insightMenuItemsProvider: props.insightMenuItemsProvider },
                                React.createElement(DashboardComponentsProvider, { ErrorComponent: (_a = props.ErrorComponent) !== null && _a !== void 0 ? _a : DefaultError, LoadingComponent: (_b = props.LoadingComponent) !== null && _b !== void 0 ? _b : DefaultLoading, LayoutComponent: (_c = props.LayoutComponent) !== null && _c !== void 0 ? _c : DefaultDashboardLayout, InsightComponentProvider: insightProvider, InsightBodyComponentProvider: insightBodyProvider, InsightMenuButtonComponentProvider: insightMenuButtonProvider, InsightMenuComponentProvider: insightMenuProvider, KpiComponentProvider: kpiProvider, WidgetComponentProvider: widgetProvider, ButtonBarComponent: (_d = props.ButtonBarComponent) !== null && _d !== void 0 ? _d : DefaultButtonBar, MenuButtonComponent: (_e = props.MenuButtonComponent) !== null && _e !== void 0 ? _e : DefaultMenuButton, TopBarComponent: (_f = props.TopBarComponent) !== null && _f !== void 0 ? _f : DefaultTopBar, TitleComponent: (_g = props.TitleComponent) !== null && _g !== void 0 ? _g : RenderModeAwareTitle, ScheduledEmailDialogComponent: (_h = props.ScheduledEmailDialogComponent) !== null && _h !== void 0 ? _h : DefaultScheduledEmailDialog, ScheduledEmailManagementDialogComponent: (_j = props.ScheduledEmailManagementDialogComponent) !== null && _j !== void 0 ? _j : DefaultScheduledEmailManagementDialog, ShareDialogComponent: (_k = props.ShareDialogComponent) !== null && _k !== void 0 ? _k : DefaultShareDialog, SaveAsDialogComponent: (_l = props.SaveAsDialogComponent) !== null && _l !== void 0 ? _l : DefaultSaveAsDialog, DashboardAttributeFilterComponentProvider: attributeFilterProvider, DashboardDateFilterComponentProvider: dateFilterProvider, FilterBarComponent: (_m = props.FilterBarComponent) !== null && _m !== void 0 ? _m : DefaultFilterBar, SidebarComponent: (_o = props.SidebarComponent) !== null && _o !== void 0 ? _o : RenderModeAwareDashboardSidebar, InsightWidgetComponentSet: insightWidgetComponentSet, KpiWidgetComponentSet: kpiWidgetComponentSet, AttributeFilterComponentSet: attributeFilterComponentSet, EmptyLayoutDropZoneBodyComponent: (_p = props.EmptyLayoutDropZoneBodyComponent) !== null && _p !== void 0 ? _p : DefaultEmptyLayoutDropZoneBody, SaveButtonComponent: (_q = props.SaveButtonComponent) !== null && _q !== void 0 ? _q : DefaultSaveButton },
                                    React.createElement(DashboardConfigProvider, { menuButtonConfig: props.menuButtonConfig },
                                        React.createElement(DndProvider, { backend: HTML5Backend },
                                            React.createElement(LayoutResizeStateProvider, null,
                                                React.createElement("div", { className: "component-root" },
                                                    React.createElement(DragLayerComponent, null),
                                                    React.createElement(DashboardLoading, __assign({}, props)))))))))))))));
    if (props.theme || (!hasThemeProvider && !props.disableThemeLoading)) {
        return (React.createElement(ThemeProvider, { theme: props.theme, modifier: (_r = props.themeModifier) !== null && _r !== void 0 ? _r : defaultDashboardThemeModifier, backend: backend, workspace: workspace, 
            // Do not remove global theme styles on unmount, if the theme is provided as a prop,
            // and the theme loading is disabled.
            // This avoids flickering of the theme, when switching between the dashboard plugin engine and the default engine.
            removeGlobalStylesOnUnmout: !props.disableThemeLoading }, dashboardRender));
    }
    return dashboardRender;
};
//# sourceMappingURL=DashboardRenderer.js.map
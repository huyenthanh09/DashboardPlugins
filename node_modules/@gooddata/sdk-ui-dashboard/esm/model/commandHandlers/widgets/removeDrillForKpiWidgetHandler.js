// (C) 2021-2022 GoodData Corporation
import { __generator } from "tslib";
import { put, select } from "redux-saga/effects";
import { kpiWidgetDrillRemoved } from "../../events/kpi";
import { selectWidgetsMap } from "../../store/layout/layoutSelectors";
import { validateExistingKpiWidget } from "./validation/widgetValidations";
import { layoutActions } from "../../store/layout";
export function removeDrillForKpiWidgetHandler(ctx, cmd) {
    var correlationId, widgets, kpiWidget, widgetRef;
    return __generator(this, function (_a) {
        switch (_a.label) {
            case 0:
                correlationId = cmd.correlationId;
                return [4 /*yield*/, select(selectWidgetsMap)];
            case 1:
                widgets = _a.sent();
                kpiWidget = validateExistingKpiWidget(widgets, cmd, ctx);
                widgetRef = kpiWidget.ref;
                return [4 /*yield*/, put(layoutActions.replaceKpiWidgetDrill({
                        ref: widgetRef,
                        drill: undefined,
                        undo: {
                            cmd: cmd,
                        },
                    }))];
            case 2:
                _a.sent();
                return [2 /*return*/, kpiWidgetDrillRemoved(ctx, widgetRef, correlationId)];
        }
    });
}
//# sourceMappingURL=removeDrillForKpiWidgetHandler.js.map